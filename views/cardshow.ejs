<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
  <link href="/stylesheets/cardshow.css" rel="stylesheet" type="text/css">
  <script src="https://unpkg.com/boxicons@2.1.4/dist/boxicons.js"></script>
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
  <title>New Card</title>
</head>
<style>
  .buttonsContainer {
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    width: 450px;
    margin-left: 20px;
  }

  .buttonsContainer i {
    font-size: 24px;
    border-radius: 50%;
    padding: 5px
  }

  .buttonsContainer form button {
    background-color: transparent;
    border: none;
  }

  .buttonsContainer i:hover {
    background-color: #f2f2f2;
    transition: all 0.3s ease-in-out;
    cursor: pointer;
  }

  .buttonsContainer a {
    color: black;
  }

  .bg {
    height: 160px;
    width: 400px;
    border-top-left-radius: 15px;
    border-top-right-radius: 15px;
  }

  .svgContainer {
    margin-top: -1px;
    width: 100%;
  }

  /* .textContainer {
  width: 100%;
  margin-left: 20px;
  border-left: 1px dotted black;
  padding-left: 20px;
  cursor: default;
  } */

  .fullname {
    font-weight: bold;
    width: 300px;
  }

  .department {
    font-size: 24px;
    font-weight: 500;
  }

  .company {
    font-size: 24px;
    font-weight: 400;
    font-style: italic;
  }

  .additionInfo {
    display: flex;
    flex-direction: column;
    width: 100%;
    margin-top: 30px;
  }

  .additionInfo a:hover {
    transform: scale(1.02);
    transition: transform 0.3s ease-in-out;
  }

  .additionInfo div:hover {
    transform: scale(1.02);
    transition: transform 0.3s ease-in-out;
  }

  .additional {
    display: flex;
    align-items: center;
    padding: 6px 20px;
    text-decoration: none;
    color: black;
  }

  .additional:hover {
    background-color: rgb(250, 245, 255);
  }

  .additional i {
    font-size: 20px;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
  }

  .additionalText {
    margin-left: 10px;
    font-weight: normal;
  }


  .bodyContainer {
    display: flex;
    flex-direction: row;
    margin-top: 20px;
    flex-wrap: wrap;
    align-items: flex-start;
  }

  .cardBack {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 20px 20px;
    width: 400px;
    border-radius: 20px;
    box-shadow: 0px 3px 9px 0px rgba(0, 0, 0, 0.3);
    -webkit-box-shadow: 0px 3px 9px 0px rgba(0, 0, 0, 0.3);
    -moz-box-shadow: 0px 3px 9px 0px rgba(0, 0, 0, 0.3);
  }

  .cardHeading {
    margin-bottom: 25px;
  }

  .qrCode {
    width: 150px;
    height: 150px;
    margin-bottom: 40px;
  }

  .socialMediaIcons {
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    width: 150px;
    font-size: 24px;
  }

  .socialMediaIcons a {
    text-decoration: none;
  }

  .copyTextButton {
    margin: 20px 0px;
    display: flex;
    flex-direction: row;
    align-items: center;
    text-transform: uppercase;
    background-color: white;
    color: #285DEC;
    border: 1px solid #285DEC;
    padding: 5px 5px;
    border-radius: 5px;
    transition: all 0.5s ease-in-out;
  }

  .copyTextButton:hover {
    background-color: #e1e9ff;
  }

  .copyTextButton i {
    margin-right: 7px;
    font-size: 20px;
  }

  .tabNavigator {
    display: flex;
    flex-direction: row;
    width: 100%;
    align-items: center;
    justify-content: center;
    border-radius: 10px;
    border: 1px solid #285DEC;
  }

  .tab {
    width: 33%;
    height: 70px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    cursor: pointer;
  }

  .tab i {
    font-size: 24px;
    color: #285DEC;
  }

  .borderRight {
    border-right: 1px solid #285DEC;
  }

  .borderLeft {
    border-left: 1px solid #285DEC;
  }

  .tabText {
    color: #285DEC;
    margin: 0;
  }

  .none {
    height: 350px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    position: relative;
  }

  .none::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-image: url(../images/upgrade.png);
    background-size: cover;
    background-position: center;
    filter: blur(5px);
    z-index: -1;
  }

  .buttonStylesUpgrade {
    background-color: blueviolet;
    border: none;
    color: white;
    padding: 6px 10px;
    border-radius: 10px;
    transition: all 0.2s ease-in-out;
    filter: blur(-5px);
  }

  .buttonStylesUpgrade:hover {
    background-color: rgb(124, 14, 228);
  }

  .buttonStylesUpgrade a {
    text-decoration: none;
    color: white;
  }


  .analyticsContainer {
    width: 280px;
    height: auto;
    padding: 40px 20px;
    margin-left: 10px;
    border-radius: 20px;
    box-shadow: 0px 3px 9px 0px rgba(0, 0, 0, 0.3);
    -webkit-box-shadow: 0px 3px 9px 0px rgba(0, 0, 0, 0.3);
    -moz-box-shadow: 0px 3px 9px 0px rgba(0, 0, 0, 0.3);
  }

  .headingContainer {
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    align-items: center;
  }

  .headTitle {
    font-weight: 400;
    font-size: x-large;
  }

  .contents {
    display: flex;
    flex-direction: row;
    width: 100%;
    height: 120px;
    /* align-items: center; */
  }

  .combinedText {
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    width: 15%;
  }

  .anInteger {
    font-size: 30px;
    font-weight: 500;
    padding: 0;
    margin: 0;
  }

  .anText {
    padding: 0;
    margin-top: -12px;
    font-size: 18px;
    margin-bottom: 0;
  }

  #viewCounter {
    width: 85%;
    height: 100%;
  }

  #bootBtn a {
    color: white;
    text-decoration: none;
  }

  .cardSettingBtn {
    background-color: aqua;
    padding: 7px 0;
    width: 100%;
  }

  .settingButton {
    border: none;
    background-color: transparent;
  }

  .headlineContainer {
    padding-left: 20px;
    margin-top: 10px;
    cursor: default;
  }

  .headline {
    font-size: 18px;
    font-weight: 400;
    margin-bottom: 0;
  }

  .prefferdNameContainer {
    padding-left: 20px;
    margin-top: 10px;
    display: flex;
    flex-direction: row;
    align-items: center;
    cursor: default;
  }

  .prefferdNameContainer i {
    color: #817c7c;
    margin: 0;
    margin-right: 5px;
    font-size: 18px;
  }

  .textContent {
    font-size: 18px;
    color: #817c7c;
    margin: 0;
  }

  .active {
    background-color: #285DEC;
    border-radius: 10px;
    transition: all 0.2s ease-in-out;
  }

  .active p {
    color: white;
  }

  .active i {
    color: white;
  }

  .renewBtn {
    text-decoration: none;
    text-transform: capitalize;
    padding: 5px 10px;
    background-color: blueviolet;
    border-radius: 5px;
  }

  @media(max-width:990px) {
    .bodyContainer {
      display: flex;
      flex-direction: column;
      margin-top: 20px;
      flex-wrap: wrap;
      align-items: flex-start;
    }

    .buttonsContainer {
      display: flex;
      flex-direction: row;
      justify-content: space-between;
      flex-wrap: wrap;
      width: auto;
      margin-left: 20px;
    }

    .cardBack {
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px 20px;
      width: 100%;
      margin-bottom: 10px;
      border-radius: 20px;
      box-shadow: 0px 3px 9px 0px rgba(0, 0, 0, 0.3);
      -webkit-box-shadow: 0px 3px 9px 0px rgba(0, 0, 0, 0.3);
      -moz-box-shadow: 0px 3px 9px 0px rgba(0, 0, 0, 0.3);
    }

    .analyticsContainer {
      width: 100%;
      height: auto;
      padding: 40px 20px;
      margin-left: 0px;
      border-radius: 20px;
      box-shadow: 0px 3px 9px 0px rgba(0, 0, 0, 0.3);
      -webkit-box-shadow: 0px 3px 9px 0px rgba(0, 0, 0, 0.3);
      -moz-box-shadow: 0px 3px 9px 0px rgba(0, 0, 0, 0.3);
    }
  }

</style>

<body>
  <div class="canvas">
    <%- include('partials/canvassidenavbar') %>
    <div class="topNavbar">
      <%- include('partials/canvasnavbar') %>
      <%- include('partials/flash') %>
      <div class="buttonsContainer">
        <a href="/user/<%= user._id %>">
          <i alt="Go back" class='bx bx-arrow-back'></i>
        </a>
        <a href="/card/<%=card._id%>/edit">
          <i class='bx bxs-edit-alt'></i>
        </a>
        <button class="settingButton" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasRight" aria-controls="offcanvasRight">
          <i class='bx bxs-cog'></i>
        </button>
        <%- include('partials/offcanvasright') %>
        <% if(user.subscription.toLowerCase()=='free' && user.cards.length>= 2){ %>
        <a id="liveToastBtn">
          <i class='bx bxs-copy-alt'></i>
        </a>
        <%- include('partials/toast') %>
        <% }else{ %>
        <a href="/card/dublicate/<%=card._id%>">
          <i class='bx bxs-copy-alt'></i>
        </a>
        <% } %>
        <a href="/download/<%= card._id %>" download="qr_code.png">
          <i class='bx bxs-download'></i>
        </a>
        <form action="/card/<%=card._id%>?_method=DELETE" method="post">
          <button type="submit"><i class='bx bxs-trash'></i></button>
        </form>
      </div>
      <div class="bodyContainer">
        <%- include('partials/cardfront') %>
        <div class="cardBack">
          <h5 class="cardHeading">Send Card</h5>
          <div style="display: flex; flex-direction: column; align-items: center;" index="0" class="screen">
            <% if(card.personalLink) {%>
            <a href="/view/<%= card.personalLink %>/<%= card._id %>" target="_blank">
              <img class="qrCode" src="<%= card.qrCode %>" />
            </a>
            <% }else{ %>
            <a href="/view/card/<%= card._id %>" target="_blank">
              <img class="qrCode" src="<%= card.qrCode %>" />
            </a>
            <% } %>
            <div class="socialMediaIcons">
              <a style="color: #3b5998;" href="https://www.facebook.com/sharer/sharer.php?u=digibizcard.lk/view/card/<%= card._id %>">
                <i class='bx bxl-facebook-circle'></i>
              </a>
              <a style="color: #00acee;" href="https://twitter.com/intent/tweet?url=digibizcard.lk/view/card/<%= card._id %>&text=<%= card.cardName %>">
                <i class='bx bxl-twitter'></i>
              </a>
              <a style="color: #0072b1;" href="https://www.linkedin.com/sharing/share-offsite/?url=digibizcard.lk/view/card/<%= card._id %>">
                <i class='bx bxl-linkedin-square'></i>
              </a>
              <a style="color: #25d366;" href="https://web.whatsapp.com/send?text=digibizcard.lk/view/card/<%= card._id %>">
                <i class='bx bxl-whatsapp'></i>
              </a>
              <a style="color: black;" href="mailto:?subject=Here's my digital business card!&body=Hello,%0D%0A%0D%0AHere's my digital business card! I recommend signing up to this link https://www.digibizcard.lk so you'll always have my latest contact information.%0D%0A%0D%0A-<%=card.firstName%>%0D%0A%0D%0AMy Card: https://www.digibizcard.lk/view/card/<%= card._id %>">
                <i class='bx bxs-envelope'></i>
              </a>
            </div>
            <% if(card.personalLink) {%>
            <button style="margin: 10px auto;" id="copy-btn" data-clipboard-text="https://digibizcard.lk/view/<%= card.personalLink %>/<%= card._id %>" class="copyTextButton">
              <i id="icon" class='bx bxs-envelope'></i>
              <span>Copy Link</span>
            </button>
            <% } else{%>
            <button style="margin: 10px auto;" id="copy-btn" data-clipboard-text="https://digibizcard.lk/view/card/<%= card._id %>" class="copyTextButton">
              <i id="icon" class='bx bxs-envelope'></i>
              <span>Copy Link</span>
            </button>
            <% } %>
          </div>
          <div index="1" class="screen d-none">
            <p class="message text-center">Your card will be sent over the DigiBizCard network, which is a secure and reliable platform.</p>
            <p class="emailCardText">Email your "<%= card.cardName %>" card to:</p>
            <form method="post" action="/sendcard/<%= card._id %>" class="validate" novalidate>
              <input required placeholder="Name of the person" type="text" id="name" name="name" class="form-control mb-3" />
              <input required placeholder="Email of the person" type="email" id="email" name="email" class="form-control mb-3" />
              <textarea placeholder="Type in the (optional) message if you want it to be send" type="text" id="name" name="emailMessage" class="form-control mb-3"></textarea>
              <button type="submit" class="btn btn-primary w-100 mb-3">Send</button>
            </form>
          </div>
          <div index="2" class="screen d-none">
            <p class="message text-center">Your card will be sent over the DigiBizCard network, which is a secure and reliable platform.</p>
            <p class="emailCardText">Text your "<%= card.cardName %>" card to:</p>
            <form action="/send/sms/<%= card._id %>" method="post" class="validate" novalidate>
              <input required placeholder="Name" type="text" id="name" name="name" class="form-control mb-3" />
              <div class="input-group mb-3">
                <span class="input-group-text">+94</span>
                <input required maxlength="9" placeholder="Contact no." type="tel" name="contact" class="form-control" />
              </div>
              <textarea placeholder="Message" type="text" id="name" name="textMessage" class="form-control mb-3"></textarea>
              <button type="submit" class="btn btn-primary w-100 mb-3">Send</button>
            </form>
          </div>
          <div class="tabNavigator">
            <div class="tab borderRight active">
              <i class='bx bx-qr'></i>
              <p class="tabText">Qr Code</p>
            </div>
            <div class="tab">
              <i class='bx bxs-envelope'></i>
              <p class="tabText">Email</p>
            </div>
            <div class="tab borderLeft">
              <i class='bx bxs-message-minus'></i>
              <p class="tabText">text</p>
            </div>
          </div>
        </div>
        <% if(user.subscription.toLowerCase()!=='free' ){ %>
        <div class="analyticsContainer">
          <div data-card-id="<%= card._id %>" class="headingContainer">
            <h4 class="headTitle">Analytics</h4>
          </div>
          <div class="contents">
            <canvas style="width: 480; height: 240;" id="viewCounter"></canvas>
          </div>
          <div class="contents">
            <canvas id="saveCount" style="width: 480; height: 240;"></canvas>
          </div>
          <div class="contents">
            <canvas id="contactCount" style="width: 480; height: 240;"></canvas>
          </div>
          <% } else{%>
          <div class="analyticsContainer">
            <div data-card-id="<%= card._id %>" class="headingContainer">
              <h4 class="headTitle">Analytics</h4>
            </div>
            <div class="none">
              <button class="buttonStylesUpgrade"><a href="/payform?package=professional">Upgrade Now</a></button>
            </div>
          </div>
        </div>
        <% } %>
      </div>
    </div>





  </div>
  <!--  -->
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="/javascripts/cardshow.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js" integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN" crossorigin="anonymous"></script>
  <script>
    (() => {
      'use strict'

      // Fetch all the forms we want to apply custom Bootstrap validation styles to
      const forms = document.querySelectorAll('.validate')


      // Loop over them and prevent submission
      Array.from(forms)
        .forEach(form => {
          form.addEventListener('submit', event => {
            if (!form.checkValidity()) {
              event.preventDefault()
              event.stopPropagation()
            }

            form.classList.add('was-validated')
          }, false)
        })
    })()
    const form = document.getElementById('form');
    form.addEventListener('submit', function(event) {
      const customLink = document.getElementById("customLink");
      if (customLink.value.includes(" ")) {
        customLink.setCustomValidity("Spaces are not allowed")
        event.preventDefault();
      } else {
        customLink.setCustomValidity("")
      }
    })

  </script>
</body>

</html>
